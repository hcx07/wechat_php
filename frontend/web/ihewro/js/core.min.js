/*! handsome 2017-10-14 */

var _handsomeCustomizerSettings={defaults:{"header-fixed":LocalConst.THEME_HEADER_FIX,"aside-fixed":LocalConst.THEME_ASIDE_FIX,"aside-folded":LocalConst.THEME_ASIDE_FOLDED,"aside-dock":LocalConst.THEME_ASIDE_DOCK,"layout-boxed":LocalConst.THEME_CONTAINER_BOX,color:LocalConst.THEME_COLOR},sections:{settings:{"header-fixed":LocalConst.HEADER_FIX,"aside-fixed":LocalConst.ASIDE_FIX,"aside-folded":LocalConst.ASIDE_FOLDED,"aside-dock":LocalConst.ASIDE_DOCK,"layout-boxed":LocalConst.CONTAINER_BOX},colors:[{navbarHeader:"bg-black",navbarCollapse:"bg-white-only",aside:"bg-black"},{navbarHeader:"bg-dark",navbarCollapse:"bg-white-only",aside:"bg-dark"},{navbarHeader:"bg-white-only",navbarCollapse:"bg-white-only",aside:"bg-black"},{navbarHeader:"bg-primary",navbarCollapse:"bg-white-only",aside:"bg-dark"},{navbarHeader:"bg-info",navbarCollapse:"bg-white-only",aside:"bg-black"},{navbarHeader:"bg-success",navbarCollapse:"bg-white-only",aside:"bg-dark"},{navbarHeader:"bg-danger",navbarCollapse:"bg-white-only",aside:"bg-dark"},{navbarHeader:"bg-black",navbarCollapse:"bg-black",aside:"bg-white b-r"},{navbarHeader:"bg-dark",navbarCollapse:"bg-dark",aside:"bg-light"},{navbarHeader:"bg-info dker",navbarCollapse:"bg-info dker",aside:"bg-light dker b-r"},{navbarHeader:"bg-primary",navbarCollapse:"bg-primary",aside:"bg-dark"},{navbarHeader:"bg-info dker",navbarCollapse:"bg-info dk",aside:"bg-black"},{navbarHeader:"bg-success",navbarCollapse:"bg-success",aside:"bg-dark"},{navbarHeader:"bg-danger dker bg-gd",navbarCollapse:"bg-danger dker bg-gd",aside:"bg-dark"}]},localStorageKey:"handsome_customizer_settings"};window.wp=window.wp||{},function(a){wp.template=_.memoize(function(b){var c,d={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(e){return(c=c||_.template(a("#tmpl-"+b).html(),d))(e)}})}(jQuery),function(a,b,c,d,e){"use strict";function f(){function c(){r||(r=!0,q=f().appendTo("body"),i())}function f(){var b={sections:d.sections,defaults:a.extend({},d.defaults,p())},c=wp.template("customizer"),e=c(b),e=a(e);return e.find(":input").change(g),e.find("[name=reset]").click(h),e}function g(){var b=a(this).attr("name"),c=m(b);j(b,c),p(b,c),o("aside-fixed")&&o("aside-dock")&&!o("header-fixed")&&(m("header-fixed",!0),j("header-fixed",!0),p("header-fixed",!0))}function h(){a.each(d.defaults,function(a,b){m(a,b),j(a,b)}),p(null,null)}function i(){a.each(o(),j)}function j(b,c){switch(b){case"header-fixed":case"aside-fixed":case"aside-folded":case"aside-dock":case"layout-boxed":var d=(c?"add":"remove")+"Class",e=a(".app");"layout-boxed"===b?(e[d]("container"),a("html")[d]("bg")):e[d]("app-"+b);break;case"color":k(c)}}function k(a){l("#header > .navbar-header","navbarHeader",a),l("#header > .collapse","navbarCollapse",a),l("#aside","aside",a)}function l(b,c,e){for(var f=d.sections.colors,g=f[e],h=a(b),i=0;i<f.length;++i)h.removeClass(f[i][c]);h.addClass(g[c])}function m(b,c){var d;return q.find(":input").each(function(){var f,g=a(this);if(g.attr("name")===b){if(f=g.attr("type"),c===e)switch(f){case"checkbox":d=g.prop("checked");break;case"radio":if(!g.prop("checked"))return;d=g.val();break;default:d=g.val()}else switch(f){case"checkbox":g.prop("checked",c);break;case"radio":if(g.val()!=c)return;g.prop("checked",!0);break;default:g.val(c)}return!1}}),d!==e&&(d=n(b,d)),d}function n(b,c){switch(b){case"color":c=!a.isNumeric(c)||c<=0?0:c>d.sections.colors.length-1?d.sections.colors.length-1:parseInt(c);break;default:c=!!c}return c}function o(b){var c=a.extend({},d.defaults);return a.each(c,function(a){var b=m(a);b!==e&&(c[a]=b)}),b===e?c:c[b]}function p(b,c){var f,g=d.localStorageKey,h=s.getItem(g);return f=h?JSON.parse(h):{},b?c===e?f[b]:(null===c?delete f[b]:f[b]=c,a.isEmptyObject(f)?s.removeItem(g):s.setItem(g,JSON.stringify(f))):null===b&&null===c?s.removeItem(g):f}var q,r=!1,s=b.localStorage;return s&&a(c),{load:c,generateCustomizer:f,formChange:g,formResetDefaults:h,loadStyle:i,setStyle:j,setAllColor:k,setPartColor:l,formItem:m,sanitizeSetting:n,getCurrentSettings:o,saveSettings:p}}b.handsome=b.handsome||{},b.handsome.customizer=new f}(jQuery,window,document,_handsomeCustomizerSettings);var initTheme=function(){$(".off-screen-toggle").click(function(){$("#aside").toggleClass("off-screen")}),$(document).on("click","[ui-toggle-class]",function(a){a.preventDefault();var b=$(a.target);b.attr("ui-toggle-class")||(b=b.closest("[ui-toggle-class]"));var c=b.attr("ui-toggle-class").split(","),d=b.attr("target")&&b.attr("target").split(",")||Array(b),e=0;$.each(c,function(a,b){var f=d[d.length&&e];$(f).toggleClass(c[a]),e++}),b.toggleClass("active")}),$(document).on("click","[data-toggle-class]",function(a){a.preventDefault();var b=$(this),c=b.data("toggle-class"),d={};$.each(c.split(","),function(){var a=$.trim(this);if(a){var b=a.split("="),c=b[0],e=b[1];d[c]=e}}),$.each(d,function(a,b){$(a).toggleClass(b)})});var a;$(document).on("click","[ui-nav] a",function(b){a&&a.trigger("mouseleave.nav");var c=$(this);c.parent().siblings(".active").toggleClass("active"),c.next().is("ul")&&c.parent().toggleClass("active")&&b.preventDefault(),c.next().is("ul")||$(window).width()<768&&$(".off-screen").removeClass("show off-screen")}),$(document).on("mouseenter","[ui-nav] a",function(b){if(a&&a.trigger("mouseleave.nav"),$("> .nav",$(".app-aside")).remove(),$(".app-aside-fixed.app-aside-folded").length&&!($(window).width()<768)){var c,d=$(b.target),e=$(window).height();!d.is("a")&&(d=d.closest("a")),d.next().is("ul")&&(a=d.next(),d.parent().addClass("active"),c=d.parent().position().top+50,a.css("top",c),c+a.height()>e&&a.css("bottom",0),c+150>e&&a.css("bottom",e-c-50).css("top","auto"),a.appendTo(".app-aside"),a.on("mouseleave.nav",function(b){a.appendTo(d.parent()),a.off("mouseleave.nav").css("top","auto").css("bottom","auto"),d.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(a){a&&a.trigger("mouseleave.nav")}))}}),$(document).on("mouseleave",".app-aside",function(b){a&&a.trigger("mouseleave.nav"),$("> .nav",$(".app-aside")).remove()}),(!!navigator.userAgent.match(/MSIE/i)||!!navigator.userAgent.match(/Trident.*rv:11\./))&&$("html").addClass("ie"),/iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/.test(window.navigator.userAgent||window.navigator.vendor||window.opera)&&$("html").addClass("smart")};+function(a){"use strict";a(function(){initTheme(),b(),toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"100",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"swing",showMethod:"slideDown",hideMethod:"slideUp"},i(),m(),a(".skPlayer-list-switch").bind("click",function(){player.toggleList()}),a("#searchform").submit(function(){a.pjax.submit(event,"#content",{fragment:"#content",timeout:6e3})})});var b=function(){a('[data-toggle="tooltip"]').tooltip(),LocalConst.COMMENT_SYSTEM==LocalConst.COMMENT_SYSTEM_ROOT?(j(),"function"==typeof registCommentEvent&&registCommentEvent(),LocalConst.IS_PAJX_COMMENT?l():n()):LocalConst.COMMENT_SYSTEM==LocalConst.COMMENT_SYSTEM_CHANGYAN&&k(),LocalConst.THEME_HEADER_FIX&&p(),LocalConst.THEME_TOC&&g(),d(),e(),h(),c(),f(),a("#post-content table").wrap("<div class='table-responsive'></div>"),LocalConst.THEME_HIGHLIGHT_CODE&&o()},c=function(){var b=document.getElementById("comment");a("#image-insert").bind("click",function(){var a=prompt("请输入图片地址","//");a&&(b.value+='<img src="'+a+'" rel="external nofollow" class="b b-a wrapper-xs bg-white img-responsive pic-time">')}),a("#video-insert").bind("click",function(){var a=prompt("请输入视频地址（.mp4）","//");a&&(b.value+='<video src="'+a+'"></video>')}),a("#music-insert").bind("click",function(){var a=prompt("请输入音乐地址（.mp3）","//");a&&(b.value+='<audio src="'+a+'"></audio>')})},d=function(){a("#post-content video, #comments video").each(function(){void 0!==a(this).attr("controls")&&a(this).removeAttr("controls"),void 0===a(this).attr("preload")&&a(this).attr("preload","preload"),a(this).wrap('<div class="kyt-player"></div>'),a(this).parent().append('<div class="play-button"></div>').css("height",.6*a(this).width()),a(this).bind("click",function(){a(this).next(".play-button").is(":hidden")&&(a(this).next(".play-button").css("display","block"),a(this).removeAttr("controls"),a(this).get(0).pause())})}),a(window).resize(function(){a(".kyt-player").each(function(){a(this).css("height",.6*a(this).width())})}),a("#post-content,#comments").delegate(".play-button","click",function(b){a(this).is(":visible")?(a(this).css("display","none"),a(this).parent().children("video").attr("controls","controls"),a(this).parent().children("video")[0].play()):(a(this).css("display","block"),a(this).parent().children("video").attr("controls","controls"),a(this).parent().children("video")[0].play())})},e=function(){a("#post-content audio, #comments audio").each(function(){var b,c;void 0!==a(this).attr("controls")&&a(this).removeAttr("controls"),void 0===a(this).attr("preload")&&a(this).attr("preload","preload"),a(this).wrap('<div class="weixinAudio"></div>'),a(this).parent().append('<div class="db audio_area"><div class="audio_wrp db"><div class="audio_play_area"><i class="icon_audio_default"></i><i class="icon_audio_playing"></i></div><div class="audio_length tips_global">00:00</div><div class="db audio_info_area"><strong class="db audio_title">&nbsp;</strong><span class="audio_source tips_global">&nbsp;</span></div><div class="progress_bar" style="width: 0%;"></div></div></div>'),void 0!==a(this).attr("title")&&(b=a(this).attr("title"),a(this).parent().find(".audio_title").text(b)),void 0!==a(this).attr("tips")&&(c=a(this).attr("tips"),a(this).parent().find(".audio_source").text(c)),void 0!==a(this).attr("large")&&a(this).parent().find(".audio_wrp").attr("class","audio_wrp2")});var b=a(".weixinAudio").weixinAudio();a(".weixinAudio").on("click",function(c){var d=a(this),e=d.index(".weixinAudio");a.each(b,function(a,b){a!="weixinAudio"+e&&b.pause()})})},f=function(){a("#post-content img, #comments img").each(function(){var b=a(this),c=(b.attr("title"),b.parent("a")),d=typeof b.attr("noGallery");void 0!==b.attr("max")&&b.wrap('<div class="max-img"></div>'),"undefined"===d&&(c.size()<1&&(c=b.wrap('<a data-fancybox="gallery" no-pjax data-type="image" href="'+this.getAttribute("src")+'"></a>').parent("a")),c.addClass("light-link"))})},g=function(){a("#toc").tocify({context:"#postpage",selectors:"h2,h3,h4",extendPage:!1,hideEffect:"slidUp",scrollTo:50}).find("li").length||a("#tag_toc").hide();var b=a("#tag_toc");if(b.length>0){var c=b.offset().top;a(window).scroll(function(){a(window).scrollTop()>c?a("#tag_toc").addClass("fixed"):a("#tag_toc").removeClass("fixed")})}},h=function(){a(".show_hide_div").bind("click",function(){a("#author_info").toggleClass("hide")})},i=function(){var b=a("#goToTop");a(b).click(function(){a("body,html").animate({scrollTop:0},600)}),a(window).scrollTop()>200&&b.addClass("hide"),a(window).scroll(function(){a(window).scrollTop()>200?b.removeClass("hide"):b.addClass("hide")})},j=function(){var a=document.getElementsByClassName("OwO")[0],b=document.getElementsByClassName("OwO-textarea")[0];if(void 0!=a&&void 0!=b){new OwO({logo:LocalConst.EMOJI,container:a,target:b,api:LocalConst.BASE_SCRIPT_URL+"usr/OwO.json",position:"down",width:"100%",maxHeight:"220px"})}},k=function(){window.changyan=void 0,window.cyan=void 0,1==a("#SOHUCS").length&&(a("#spin_comment_changyan").addClass("show inline"),a.getScript("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:LocalConst.ChANGYAN_APP_KEY,conf:LocalConst.CHANGYAN_CONF}),a("#spin_comment_changyan").removeClass("show inline")}))},l=function(){function b(){a(f+" a").click(function(){j=a(this).parent().parent().parent().parent().attr("id"),a(g).focus()}),a("#cancel-comment-reply-link").click(function(){j=""})}function c(b){a(h).attr("disabled",!1).fadeTo("",1)}var d=a(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body"),e="#comments .comments-title",f=".comment-reply",g="#comment",h="#submit",i="",j="";b(),a("#comment_form").submit(function(){if(a(h).attr("disabled",!0).fadeTo("slow",.5),a("#comment_form").find("#author")[0]){if(""==a("#comment_form").find("#author").val())return toastr.error(LocalConst.COMMENT_NAME_INFO),c("#error"),!1;if(""==a("#comment_form").find("#mail").val())return toastr.error(LocalConst.COMMENT_EMAIL_INFO),c("#error"),!1;if(!/^[^@\s<&>]+@([a-z0-9]+\.)+[a-z]{2,4}$/i.test(a("#comment_form").find("#mail").val()))return toastr.error(LocalConst.COMMENT_EMAIL_LEGAL_INFO),c("#error"),!1}var k=a("#comment_form").find(g).val().replace(/(^\s*)|(\s*$)/g,"");return null==k||""==k?(toastr.error(LocalConst.COMMENT_CONTENT_INFO),c("#error"),!1):(a(h).addClass("active"),a("#spin").addClass("show inline"),a.ajax({url:a(this).attr("action"),type:a(this).attr("method"),data:a(this).serializeArray(),error:function(){return toastr.error(submitError),a(h).removeClass("active"),a("#spin").removeClass("show inline"),c("#error"),!1},success:function(k){a(h).removeClass("active"),a("#spin").removeClass("show inline");try{if(!a(".comment-list",k).length)return toastr.info(LocalConst.COMMENT_CONTENT_LEGAL_INFO),a(h).removeClass("active"),a("#spin").removeClass("show inline"),c("#error"),!1;i=a(".comment-list",k).html().match(/id=\"?comment-\d+/g).join().match(/\d+/g).sort(function(a,b){return a-b}).pop(),a(".page-navigator .prev").length&&""==j&&(i=""),c("#success"),j?(k=a("#comment-"+i,k).hide(),a("#"+j).find(".comment-children").length<=0&&a("#"+j).append("<div class='comment-children list-unstyled m-l-xxl'><ol class='comment-list'></ol></div>"),i&&a("#"+j+" .comment-children .comment-list").prepend(k),j=""):(k=a("#comment-"+i,k).hide(),a(".comment-list").length||a("#comments").prepend('<h4 class="comments-title m-t-lg m-b special"> 0 条评论</h4><ol class="comment-list"></ol>'),a(".comment-list").prepend(k)),a("#comment-"+i).fadeIn();var l;a(e).length&&(l=parseInt(a(e).text().match(/\d+/)),a(e).html(a(e).html().replace(l,l+1))),TypechoComment.cancelReply(),a(g).val(""),a(f+" a, #cancel-comment-reply-link").unbind("click"),b(),a(h).attr("disabled",!1).fadeTo("slow",1),i?d.animate({scrollTop:a("#comment-"+i).offset().top-50},500):d.animate({scrollTop:a("#comments").offset().top-50},500)}catch(a){window.location.reload()}}}),!1)})},m=function(){function b(){a("#login-submit").attr("disabled",!1).fadeTo("",1)}a("form.protected").submit(function(){return a.ajax({url:a(this).attr("action"),type:a(this).attr("method"),data:a(this).serializeArray(),error:function(){return toastr.error(submitError),!1},success:function(b){try{if(a("#post-content",b).length<=0)return toastr.error(LocalConst.SUBMIT_PASSWORD_INFO),!1;var c=a("#post-content",b).html(),d=a("#comments",b).html(),e=a("#small_widgets h1",b).html();a("#post-content").html(c),a("#comments").html(d),a("#small_widgets h1").html(e)}catch(a){window.location.reload()}}}),!1}),a("#Login_form").submit(function(){if(a(this).hasClass("banLogin"))return location.reload(),!1;a("#login-submit").attr("disabled",!0).fadeTo("slow",.5);var c=a("#navbar-login-user").val(),d=a("#navbar-login-password").val();return""==c?(toastr.error(LocalConst.LOGIN_USERNAME_INFO),a("#navbar-login-user").focus(),b(),!1):""==d?(toastr.error(LocalConst.LOGIN_PASSWORD_INFO),a("#navbar-login-password").focus(),b(),!1):(a("#login-submit").addClass("active"),a("#spin-login").addClass("show inline"),a.ajax({url:a(this).attr("action"),type:a(this).attr("method"),data:a(this).serializeArray(),error:function(){return toastr.error(LocalConst.LOGIN_SUBMIT_ERROR),b(),!1},success:function(c){a("#login-submit").removeClass("active"),a("#spin-login").removeClass("show inline");try{if(a("#Logged-in",c).length<=0)return toastr.error(LocalConst.LOGIN_SUBMIT_INFO),b(),!1;c=a("#easyLogin",c).html(),a("#easyLogin").html(c),toastr.success(LocalConst.LOGIN_SUBMIT_SUCCESS)}catch(a){alert("按下F12，查看输出错误信息"),console.log("error!\n"+a)}}}),!1)})},n=function(){a("#submit").bind("click",function(){var b=a("#author").val(),c=a("#mail").val();return""==a("#comment").val()?(toastr.error(LocalConst.COMMENT_CONTENT_INFO),a("#comment").focus(),!1):""==b?(toastr.error(LocalConst.COMMENT_NAME_INFO),a("#author").focus(),!1):""==c?(toastr.info(LocalConst.COMMENT_EMAIL_INFO),a("#mail").focus(),!1):(a(this).addClass("active"),a("#spin").addClass("show inline"),void a("#comment_form").submit())})},o=function(){a("pre code").each(function(a,b){hljs.highlightBlock(b)})},p=function(){a("#comments,#small_widgets").delegate("a[href^=\\#][href!=\\#]","click",function(){var b=document.getElementById(this.hash.slice(1));if(b){var c=a(b).offset().top-50;return a("html,body").animate({scrollTop:c},300),!1}}),window.location.hash.indexOf("#")>=0&&a(window.location.hash).length&&setTimeout(function(){a("html,body").animate({scrollTop:a(window.location.hash).offset().top-50+"px"},150)},700)};window.Page={reInitAPlayer:function(){if("undefined"!=typeof APlayerOptions&&"undefined"!=typeof APlayers)for(var a=APlayerOptions.length,b=0;b<a;b++)APlayers[b]=new APlayer({element:document.getElementById("player"+APlayerOptions[b].id),narrow:!1,preload:APlayerOptions[b].preload,mutex:APlayerOptions[b].mutex,autoplay:APlayerOptions[b].autoplay,showlrc:APlayerOptions[b].showlrc,music:APlayerOptions[b].music,theme:APlayerOptions[b].theme}),APlayers[b].init()},doPJAXSendAction:function(){a("body,html").animate({scrollTop:0},100),a("#loadingbar").attr("class","butterbar active")},doPJAXCompleteAction:function(){a("#loadingbar").attr("class","butterbar hide"),a("#Login_form").hasClass("banLogin")||(a("#Login_form").addClass("banLogin"),a("#navbar-login-user").attr("disabled","disabled"),a("#navbar-login-password").attr("disabled","disabled")),this.reInitAPlayer(),b()}}}(jQuery);